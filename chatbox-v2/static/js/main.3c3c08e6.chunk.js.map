{"version":3,"sources":["Types.ts","Constants.tsx","Color.js","Contexts.tsx","Utils.ts","ClientId.ts","Badges.tsx","Content.tsx","Pronouns.tsx","Message.tsx","Chat.tsx","App.tsx","Configurator.tsx","index.tsx"],"names":["ColorAdjustmentMode","TwitchDefaultColors","DefaultConfig","channelName","fontName","fontSize","fontWeight","fontColor","showBadges","showPronouns","showUserColours","dropShadow","dropShadowBlur","dropShadowOffset","dropShadowColour","outline","outlineThickness","outlineColour","readableColours","readableBackground","readableContrast","readableMode","hslLuma","hideCommands","hideMessages","hideMessagesTimeout","blockedUsers","hue2rgb","p","q","t","bit2linear","channel","Math","pow","linear2bit","Color","protanope","deuteranope","tritanope","RGBAColor","RGBA","r","g","b","a","this","HSVAColor","HSVA","h","s","v","HSLAColor","HSLA","l","XYZAColor","XYZA","x","y","z","LUVAColor","LUVA","u","prototype","eq","rgb","fromName","name","context","_context","canvas","_canvas","document","createElement","getContext","clearRect","fillStyle","fillRect","data","getImageData","length","fromCSS","trim","charAt","fromHex","match","exec","parseInt","parseFloat","min","max","code","alpha","slice","Error","raw","fromHSVA","i","floor","f","round","undefined","fromXYZA","R","G","B","fromHSLA","toRGBA","toHSVA","fromRGBA","toHSLA","toCSS","toXYZA","toLUVA","toHex","toString","get_Y","luminance","brighten","amount","daltonize","type","cvd","CVDMatrix","hasOwnProperty","cvd_a","cvd_b","cvd_c","cvd_d","cvd_e","cvd_f","cvd_g","cvd_h","cvd_i","L","M","S","m","RR","GG","BB","_r","_g","_b","_a","hsl","d","targetLuminance","target","mid","_h","_s","_l","hsv","_v","xyz","fromLUVA","deltaGammaFactor","WHITE","uDeltaGamma","vDeltagamma","Y","KAPPA","X","_x","_y","_z","EPSILON","luv","Z","yGamma","deltaDivider","deltaFactor","uDelta","vDelta","_u","ColorAdjuster","base","mode","contrast","_contrast","_base","_mode","rebuildContrast","val","_dark","_cache","Map","lum","_luv","_luma","color","throw_errors","has","get","err","luma","out","set","ConfigContext","React","createContext","ColorContext","BadgesContext","EmotesContext","PronounsContext","fetchTwitch","path","fetch","headers","response","json","fetchJSON","Badges","props","configContext","useContext","badgeContext","urls","emoteScale","badges","badgeElements","split","badge","badgeData","push","className","alt","src","srcSet","map","str","join","Content","text","rawEmotes","emotes","isMe","test","replace","emote","emoteId","indicies","start","end","id","channelEmotes","idx","nextIdx","indexOf","sort","index","content","key","substr","config","elements","item","Pronouns","pronounsContext","display","pronouns","userMap","nick","displayMap","pronoun","fetchPronouns","Message","state","hidden","timeout","setState","setTimeout","console","log","clearTimeout","Consumer","adjuster","message","rawNick","prefix","includes","toLowerCase","params","startsWith","tags","process","charCodeAt","style","Component","contextType","Chat","connected","messages","pronounUsers","pronounDisplay","colorAdjuster","load","previousProps","cleanup","errorMessage","users","channelId","_id","connect","encodedId","encodeURIComponent","Promise","all","loadBadges","loadEmotes","loadPronouns","socket","webSocket","events","sevenTvEvents","close","WebSocket","addEventListener","onSocketOpen","bind","onSocketClose","onSocketError","onSocketMessage","badgeSets","badgeName","badgeSet","badge_sets","badgeVersion","versions","image_url_1x","image_url_2x","image_url_4x","bttvEmotes","emoteSet","Array","isArray","concat","sharedEmotes","images","e","sevenTVSubscribe","eventSource","EventSource","ev","eventUpdate","JSON","parse","action","emote_id","delete","pronounsJson","value","userName","pending","pronoun_id","sendIrc","random","reason","ircMessage","command","oldState","send","fill","fontFamily","filter","WebkitTextStroke","stroke","strokeWidth","height","viewBox","width","xmlns","xmlnsXlink","Provider","App","newConfig","decode","Buffer","from","window","location","hash","substring","Object","assign","Checkbox","checked","onChange","label","Configurator","chatConfig","newValue","preventDefault","configDiff","element","configString","btoa","String","fromCharCode","MsgPack","onSubmit","href","placeholder","onChannelNameChange","onBlur","updateChat","onClick","showHelpDialog","size","flex","onValueChange","isNaN","defaultValue","step","readOnly","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.3c3c08e6.chunk.js","sourcesContent":["export interface Configuration {\r\n  channelName: string\r\n\r\n  fontName: string\r\n  fontSize: number\r\n  fontColor: string\r\n  fontWeight: number\r\n\r\n  showBadges: boolean\r\n  showPronouns: boolean\r\n  showUserColours: boolean;\r\n  hideCommands: boolean\r\n\r\n  dropShadow: boolean\r\n  dropShadowColour?: string\r\n  dropShadowOffset?: number\r\n  dropShadowBlur?: number\r\n\r\n  outline: boolean\r\n  outlineThickness?: number;\r\n  outlineColour?: string;\r\n\r\n  readableColours: boolean;\r\n  readableBackground: string;\r\n  readableContrast: number;\r\n  readableMode: ColorAdjustmentMode;\r\n\r\n  hideMessages: boolean;\r\n  hideMessagesTimeout: number;\r\n\r\n  blockedUsers: string[]\r\n}\r\n\r\nexport interface BTTVUser {\r\n  id: number\r\n  name: string\r\n  displayName: string\r\n}\r\n\r\nexport interface BTTVEmoteImages {\r\n  \"1x\": string\r\n  \"2x\": string\r\n  \"4x\": string\r\n}\r\n\r\nexport interface BTTVUser {\r\n  channelEmotes: BTTVEmote[]\r\n  sharedEmotes: BTTVEmote[]\r\n}\r\n\r\nexport interface BTTVEmote {\r\n  id: number | string\r\n  code: string\r\n  imageType: string\r\n\r\n  userId?: string\r\n\r\n  user?: BTTVUser\r\n  images?: BTTVEmoteImages\r\n\r\n  name?: string\r\n  urls?: [size: string, url: string]\r\n}\r\n\r\nexport interface TwitchEmote {\r\n  id: string\r\n  urls: string[]\r\n  start: number\r\n  end: number\r\n}\r\n\r\nexport interface Emote {\r\n  id: string;\r\n  urls: string[]\r\n  key: string\r\n}\r\n\r\nexport enum ColorAdjustmentMode {\r\n  none,\r\n  hslLuma,\r\n  luv,\r\n  hslLoop,\r\n  rgbLoop\r\n}\r\n\r\nexport interface EmoteEventUpdate {\r\n  // The channel this update affects.\r\n  channel: string; \r\n  // The ID of the emote.\r\n  emote_id: string; \r\n  // The name or channel alias of the emote.\r\n  name: string; \r\n  // The action done.\r\n  action: \"ADD\" | \"REMOVE\" | \"UPDATE\"; \r\n  // The user who caused this event to trigger.\r\n  actor: string; \r\n  // An emote object. Null if the action is \"REMOVE\".\r\n  emote?: ExtraEmoteData; \r\n}\r\n\r\ninterface ExtraEmoteData {\r\n  // Original name of the emote.\r\n  name: string;\r\n  // The visibility bitfield of this emote.\r\n  visibility: number;\r\n  // The MIME type of the images.\r\n  mime: string;\r\n  // The TAGs on this emote.\r\n  tags: string[];\r\n  // The widths of the images.\r\n  width: [number, number, number, number];\r\n  // The heights of the images.\r\n  height: [number, number, number, number];\r\n  // The animation status of the emote.\r\n  animated: boolean;\r\n  // Infomation about the uploader.\r\n  owner: {\r\n    // 7TV ID of the owner.\r\n    id: string;\r\n    // Twitch ID of the owner.\r\n    twitch_id: string;\r\n    // Twitch DisplayName of the owner.\r\n    display_name: string;\r\n    // Twitch Login of the owner. \r\n    login: string;\r\n  }\r\n}","import { Configuration, ColorAdjustmentMode } from \"./Types\";\r\n\r\nexport const TwitchDefaultColors = [\"#FF0000\", \"#0000FF\", \"#008000\", \"#B22222\", \"#FF7F50\", \"#9ACD32\", \"#FF4500\", \"#2E8B57\", \"#DAA520\", \"#D2691E\", \"#5F9EA0\", \"#1E90FF\", \"#FF69B4\", \"#8A2BE2\", \"#00FF7F\"];\r\nexport const DefaultConfig: Configuration = {\r\n  channelName: \"\",\r\n  fontName: \"Segoe UI\",\r\n  fontSize: 15,\r\n  fontWeight: 400,\r\n  fontColor: \"#FFFFFF\",\r\n  showBadges: true,\r\n  showPronouns: true,\r\n  showUserColours: true,\r\n\r\n  dropShadow: true,\r\n  dropShadowBlur: 1,\r\n  dropShadowOffset: 1,\r\n  dropShadowColour: \"#000000\",\r\n\r\n  outline: false,\r\n  outlineThickness: 1,\r\n  outlineColour: \"#000000\",\r\n\r\n  readableColours: true,\r\n  readableBackground: \"#212121\",\r\n  readableContrast: 4.5,\r\n  readableMode: ColorAdjustmentMode.hslLuma,\r\n\r\n  hideCommands: true,\r\n  hideMessages: false,\r\n  hideMessagesTimeout: 5000,\r\n\r\n  blockedUsers: ['streamelements', 'streamlabs', 'nightbot', 'moobot', 'fossabot']\r\n}","export function hue2rgb(p, q, t) {\n\tif ( t < 0 ) t += 1;\n\tif ( t > 1 ) t -= 1;\n\tif ( t < 1/6 )\n\t\treturn p + (q-p) * 6 * t;\n\tif ( t < 1/2 )\n\t\treturn q;\n\tif ( t < 2/3 )\n\t\treturn p + (q-p) * (2/3 - t) * 6;\n\treturn p;\n}\n\nexport function bit2linear(channel) {\n\t// http://www.brucelindbloom.com/Eqn_RGB_to_XYZ.html\n\t// This converts rgb 8bit to rgb linear, lazy because the other algorithm is really really dumb\n\t//return Math.pow(channel, 2.2);\n\n\t// CSS Colors Level 4 says 0.03928, Bruce Lindbloom who cared to write all algos says 0.04045, used bruce because whynawt\n\treturn (channel <= 0.04045) ? channel / 12.92 : Math.pow((channel + 0.055) / 1.055, 2.4);\n}\n\nexport function linear2bit(channel) {\n\t// Using lazy conversion in the other direction as well\n\t//return Math.pow(channel, 1/2.2);\n\n\t// I'm honestly not sure about 0.0031308, I've only seen it referenced on Bruce Lindbloom's site\n\treturn (channel <= 0.0031308) ? channel * 12.92 : Math.pow(1.055 * channel, 1/2.4) - 0.055;\n}\n\n\nexport const Color = {};\n\nColor._canvas = null;\nColor._context = null;\n\nColor.CVDMatrix = {\n\tprotanope: [ // reds are greatly reduced (1% men)\n\t\t0.0, 2.02344, -2.52581,\n\t\t0.0, 1.0,      0.0,\n\t\t0.0, 0.0,      1.0\n\t],\n\tdeuteranope: [ // greens are greatly reduced (1% men)\n\t\t1.0,      0.0, 0.0,\n\t\t0.494207, 0.0, 1.24827,\n\t\t0.0,      0.0, 1.0\n\t],\n\ttritanope: [ // blues are greatly reduced (0.003% population)\n\t\t1.0,       0.0,      0.0,\n\t\t0.0,       1.0,      0.0,\n\t\t-0.395913, 0.801109, 0.0\n\t]\n}\n\n\nconst RGBAColor = Color.RGBA = function(r, g, b, a) {\n\tthis.r = r||0; this.g = g||0; this.b = b||0; this.a = a||0;\n};\n\nconst HSVAColor = Color.HSVA = function(h, s, v, a) {\n\tthis.h = h||0; this.s = s||0; this.v = v||0; this.a = a||0;\n};\n\nconst HSLAColor = Color.HSLA = function(h, s, l, a) {\n\tthis.h = h||0; this.s = s||0; this.l = l||0; this.a = a||0;\n};\n\nconst XYZAColor = Color.XYZA = function(x, y, z, a) {\n\tthis.x = x||0; this.y = y||0; this.z = z||0; this.a = a||0;\n};\n\nconst LUVAColor = Color.LUVA = function(l, u, v, a) {\n\tthis.l = l||0; this.u = u||0; this.v = v||0; this.a = a||0;\n};\n\n\n// RGBA Colors\n\nRGBAColor.prototype.eq = function(rgb) {\n\treturn rgb.r === this.r && rgb.g === this.g && rgb.b === this.b && rgb.a === this.a;\n}\n\nRGBAColor.fromName = function(name) {\n\tlet context = Color._context;\n\tif ( ! context ) {\n\t\tconst canvas = Color._canvas = document.createElement('canvas');\n\t\tcontext = Color._context = canvas.getContext('2d');\n\t}\n\n\tcontext.clearRect(0,0,1,1);\n\tcontext.fillStyle = name;\n\tcontext.fillRect(0,0,1,1);\n\tconst data = context.getImageData(0,0,1,1);\n\n\tif ( ! data || ! data.data || data.data.length !== 4 )\n\t\treturn null;\n\n\treturn new RGBAColor(data.data[0], data.data[1], data.data[2], data.data[3] / 255);\n}\n\nRGBAColor.fromCSS = function(rgb) {\n\tif ( ! rgb )\n\t\treturn null;\n\n\trgb = rgb.trim();\n\n\tif ( rgb.charAt(0) === '#' )\n\t\treturn RGBAColor.fromHex(rgb);\n\n\tconst match = /rgba?\\( *(\\d+%?) *, *(\\d+%?) *, *(\\d+%?) *(?:, *([\\d.]+))?\\)/i.exec(rgb);\n\tif ( match ) {\n\t\tlet r = match[1],\n\t\t\tg = match[2],\n\t\t\tb = match[3],\n\t\t\ta = match[4];\n\n\t\tif ( r.charAt(r.length-1) === '%' )\n\t\t\tr = 255 * (parseInt(r,10) / 100);\n\t\telse\n\t\t\tr = parseInt(r,10);\n\n\t\tif ( g.charAt(g.length-1) === '%' )\n\t\t\tg = 255 * (parseInt(g,10) / 100);\n\t\telse\n\t\t\tg = parseInt(g,10);\n\n\t\tif ( b.charAt(b.length-1) === '%' )\n\t\t\tb = 255 * (parseInt(b,10) / 100);\n\t\telse\n\t\t\tb = parseInt(b,10);\n\n\t\tif ( a )\n\t\t\tif ( a.charAt(a.length-1) === '%' )\n\t\t\t\ta = parseInt(a,10) / 100;\n\t\t\telse\n\t\t\t\ta = parseFloat(a);\n\t\telse\n\t\t\ta = 1;\n\n\t\treturn new RGBAColor(\n\t\t\tMath.min(Math.max(0, r), 255),\n\t\t\tMath.min(Math.max(0, g), 255),\n\t\t\tMath.min(Math.max(0, b), 255),\n\t\t\tMath.min(Math.max(0, a), 1)\n\t\t);\n\t}\n\n\treturn RGBAColor.fromName(rgb);\n}\n\nRGBAColor.fromHex = function(code, alpha = 1) {\n\tif ( code.charAt(0) === '#' )\n\t\tcode = code.slice(1);\n\n\tif ( code.length === 3 )\n\t\tcode = `${code[0]}${code[0]}${code[1]}${code[1]}${code[2]}${code[2]}`;\n\n\telse if ( code.length === 4 )\n\t\tcode = `${code[0]}${code[0]}${code[1]}${code[1]}${code[2]}${code[2]}${code[3]}${code[3]}`;\n\n\tif ( code.length === 8 ) {\n\t\talpha = parseInt(code.slice(6), 16) / 255;\n\t\tcode = code.slice(0, 6);\n\n\t} else if ( code.length !== 6 )\n\t\tthrow new Error('invalid hex code');\n\n\tconst raw = parseInt(code, 16);\n\treturn new RGBAColor(\n\t\t(raw >> 16),\t\t // Red\n\t\t(raw >> 8 & 0x00FF), // Green\n\t\t(raw & 0x0000FF),    // Blue,\n\t\talpha                // Alpha\n\t);\n}\n\nRGBAColor.fromHSVA = function(h, s, v, a) {\n\tlet r, g, b;\n\n\tconst i = Math.floor(h * 6),\n\t\tf = h * 6 - i,\n\t\tp = v * (1 - s),\n\t\tq = v * (1 - f * s),\n\t\tt = v * (1 - (1 - f) * s);\n\n\tswitch(i % 6) {\n\t\tcase 0: r = v; g = t; b = p; break;\n\t\tcase 1: r = q; g = v; b = p; break;\n\t\tcase 2: r = p; g = v; b = t; break;\n\t\tcase 3: r = p; g = q; b = v; break;\n\t\tcase 4: r = t; g = p; b = v; break;\n\t\tcase 5: r = v; g = p; b = q;\n\t}\n\n\treturn new RGBAColor(\n\t\tMath.round(Math.min(Math.max(0, r*255), 255)),\n\t\tMath.round(Math.min(Math.max(0, g*255), 255)),\n\t\tMath.round(Math.min(Math.max(0, b*255), 255)),\n\t\ta === undefined ? 1 : a\n\t);\n}\n\nRGBAColor.fromXYZA = function(x, y, z, a) {\n\tconst R =  3.240479 * x - 1.537150 * y - 0.498535 * z,\n\t\tG = -0.969256 * x + 1.875992 * y + 0.041556 * z,\n\t\tB =  0.055648 * x - 0.204043 * y + 1.057311 * z;\n\n\t// Make sure we end up in a real color space\n\treturn new RGBAColor(\n\t\tMath.max(0, Math.min(255, 255 * linear2bit(R))),\n\t\tMath.max(0, Math.min(255, 255 * linear2bit(G))),\n\t\tMath.max(0, Math.min(255, 255 * linear2bit(B))),\n\t\ta === undefined ? 1 : a\n\t);\n}\n\nRGBAColor.fromHSLA = function(h, s, l, a) {\n\tif ( s === 0 ) {\n\t\tconst v = Math.round(Math.min(Math.max(0, 255*l), 255));\n\t\treturn new RGBAColor(v, v, v, a === undefined ? 1 : a);\n\t}\n\n\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s,\n\t\tp = 2 * l - q;\n\n\treturn new RGBAColor(\n\t\tMath.round(Math.min(Math.max(0, 255 * hue2rgb(p, q, h + 1/3)), 255)),\n\t\tMath.round(Math.min(Math.max(0, 255 * hue2rgb(p, q, h)), 255)),\n\t\tMath.round(Math.min(Math.max(0, 255 * hue2rgb(p, q, h - 1/3)), 255)),\n\t\ta === undefined ? 1 : a\n\t);\n}\n\nRGBAColor.prototype.toRGBA = function() { return this; }\nRGBAColor.prototype.toHSVA = function() { return HSVAColor.fromRGBA(this.r, this.g, this.b, this.a); }\nRGBAColor.prototype.toHSLA = function() { return HSLAColor.fromRGBA(this.r, this.g, this.b, this.a); }\nRGBAColor.prototype.toCSS = function() { return `rgb${this.a !== 1 ? 'a' : ''}(${Math.round(this.r)},${Math.round(this.g)},${Math.round(this.b)}${this.a !== 1 ? `,${this.a}` : ''})`; }\nRGBAColor.prototype.toXYZA = function() { return XYZAColor.fromRGBA(this.r, this.g, this.b, this.a); }\nRGBAColor.prototype.toLUVA = function() { return this.toXYZA().toLUVA(); }\n\nRGBAColor.prototype.toHex = function() {\n\tconst rgb = this.b | (this.g << 8) | (this.r << 16);\n\treturn `#${(0x1000000 + rgb).toString(16).slice(1)}`;\n}\n\n\nRGBAColor.prototype.get_Y = function() {\n\treturn ((0.299 * this.r) + ( 0.587 * this.g) + ( 0.114 * this.b)) / 255;\n}\n\n\nRGBAColor.prototype.luminance = function() {\n\tconst r = bit2linear(this.r / 255),\n\t\tg = bit2linear(this.g / 255),\n\t\tb = bit2linear(this.b / 255);\n\n\treturn (0.2126 * r) + (0.7152 * g) + (0.0722 * b);\n}\n\n\nRGBAColor.prototype.brighten = function(amount) {\n\tamount = typeof amount === `number` ? amount : 1;\n\tamount = Math.round(255 * (amount / 100));\n\n\treturn new RGBAColor(\n\t\tMath.max(0, Math.min(255, this.r + amount)),\n\t\tMath.max(0, Math.min(255, this.g + amount)),\n\t\tMath.max(0, Math.min(255, this.b + amount)),\n\t\tthis.a\n\t);\n}\n\n\nRGBAColor.prototype.daltonize = function(type) {\n\tlet cvd;\n\tif ( typeof type === 'string' ) {\n\t\tif ( Color.CVDMatrix.hasOwnProperty(type) )\n\t\t\tcvd = Color.CVDMatrix[type];\n\t\telse\n\t\t\tthrow new Error('Invalid CVD matrix');\n\t} else\n\t\tcvd = type;\n\n\tconst cvd_a = cvd[0], cvd_b = cvd[1], cvd_c = cvd[2],\n\t\tcvd_d = cvd[3], cvd_e = cvd[4], cvd_f = cvd[5],\n\t\tcvd_g = cvd[6], cvd_h = cvd[7], cvd_i = cvd[8];\n\n\t//let L, M, S, l, m, s, R, G, B, RR, GG, BB;\n\n\t// RGB to LMS matrix conversion\n\tconst L = (17.8824 * this.r) + (43.5161 * this.g) + (4.11935 * this.b),\n\t\tM = (3.45565 * this.r) + (27.1554 * this.g) + (3.86714 * this.b),\n\t\tS = (0.0299566 * this.r) + (0.184309 * this.g) + (1.46709 * this.b);\n\n\t// Simulate color blindness\n\tconst l = (cvd_a * L) + (cvd_b * M) + (cvd_c * S),\n\t\tm = (cvd_d * L) + (cvd_e * M) + (cvd_f * S),\n\t\ts = (cvd_g * L) + (cvd_h * M) + (cvd_i * S);\n\n\t// LMS to RGB matrix conversion\n\tlet R = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s),\n\t\tG = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s),\n\t\tB = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\n\n\t// Isolate invisible colors to color vision deficiency (calculate error matrix)\n\tR = this.r - R;\n\tG = this.g - G;\n\tB = this.b - B;\n\n\t// Shift colors towards visible spectrum (apply error modifications)\n\tconst RR = (0.0 * R) + (0.0 * G) + (0.0 * B),\n\t\tGG = (0.7 * R) + (1.0 * G) + (0.0 * B),\n\t\tBB = (0.7 * R) + (0.0 * G) + (1.0 * B);\n\n\t// Add compensation to original values\n\tR = Math.min(Math.max(0, RR + this.r), 255);\n\tG = Math.min(Math.max(0, GG + this.g), 255);\n\tB = Math.min(Math.max(0, BB + this.b), 255);\n\n\treturn new RGBAColor(R, G, B, this.a);\n}\n\nRGBAColor.prototype._r = function(r) { return new RGBAColor(r, this.g, this.b, this.a); }\nRGBAColor.prototype._g = function(g) { return new RGBAColor(this.r, g, this.b, this.a); }\nRGBAColor.prototype._b = function(b) { return new RGBAColor(this.r, this.g, b, this.a); }\nRGBAColor.prototype._a = function(a) { return new RGBAColor(this.r, this.g, this.b, a); }\n\n\n// HSL Colors\n\nHSLAColor.prototype.eq = function(hsl) {\n\treturn hsl.h === this.h && hsl.s === this.s && hsl.l === this.l && hsl.a === this.a;\n}\n\nHSLAColor.fromRGBA = function(r, g, b, a) {\n\tr /= 255; g /= 255; b /= 255;\n\n\tconst max = Math.max(r,g,b),\n\t\tmin = Math.min(r,g,b),\n\n\t\tl = Math.min(Math.max(0, (max+min) / 2), 1),\n\t\td = Math.min(Math.max(0, max - min), 1);\n\n\tlet h, s;\n\n\tif ( d === 0 )\n\t\th = s = 0;\n\telse {\n\t\ts = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\t\tswitch(max) {\n\t\t\tcase r:\n\t\t\t\th = (g - b) / d + (g < b ? 6 : 0);\n\t\t\t\tbreak;\n\t\t\tcase g:\n\t\t\t\th = (b - r) / d + 2;\n\t\t\t\tbreak;\n\t\t\tcase b:\n\t\t\t\th = (r - g) / d + 4;\n\t\t}\n\t\th /= 6;\n\t}\n\n\treturn new HSLAColor(h, s, l, a === undefined ? 1 : a);\n}\n\nHSLAColor.prototype.targetLuminance = function (target) {\n\tlet s = this.s,\n\t\tmin = 0,\n\t\tmax = 1;\n\n\ts *= Math.pow(this.l > 0.5 ? -this.l : this.l - 1, 7) + 1;\n\n\tlet d = (max - min) / 2,\n\t\tmid = min + d;\n\n\tfor (; d > 1/65536; d /= 2, mid = min + d) {\n\t\tconst luminance = RGBAColor.fromHSLA(this.h, s, mid, 1).luminance()\n\t\tif (luminance > target) {\n\t\t\tmax = mid;\n\t\t} else {\n\t\t\tmin = mid;\n\t\t}\n\t}\n\n\treturn new HSLAColor(this.h, s, mid, this.a);\n}\n\nHSLAColor.prototype.toRGBA = function() { return RGBAColor.fromHSLA(this.h, this.s, this.l, this.a); }\nHSLAColor.prototype.toCSS = function() { return `hsl${this.a !== 1 ? 'a' : ''}(${Math.round(this.h*360)},${Math.round(this.s*100)}%,${Math.round(this.l*100)}%${this.a !== 1 ? `,${this.a}` : ''})`; }\nHSLAColor.prototype.toHSLA = function() { return this; }\nHSLAColor.prototype.toHSVA = function() { return this.toRGBA().toHSVA(); }\nHSLAColor.prototype.toXYZA = function() { return this.toRGBA().toXYZA(); }\nHSLAColor.prototype.toLUVA = function() { return this.toRGBA().toLUVA(); }\n\n\nHSLAColor.prototype._h = function(h) { return new HSLAColor(h, this.s, this.l, this.a); }\nHSLAColor.prototype._s = function(s) { return new HSLAColor(this.h, s, this.l, this.a); }\nHSLAColor.prototype._l = function(l) { return new HSLAColor(this.h, this.s, l, this.a); }\nHSLAColor.prototype._a = function(a) { return new HSLAColor(this.h, this.s, this.l, a); }\n\n\n// HSV Colors\n\nHSVAColor.prototype.eq = function(hsv) { return hsv.h === this.h && hsv.s === this.s && hsv.v === this.v && hsv.a === this.a; }\n\nHSVAColor.fromRGBA = function(r, g, b, a) {\n\tr /= 255; g /= 255; b /= 255;\n\n\tconst max = Math.max(r, g, b),\n\t\tmin = Math.min(r, g, b),\n\t\td = Math.min(Math.max(0, max - min), 1),\n\n\t\ts = max === 0 ? 0 : d / max,\n\t\tv = max;\n\n\tlet h;\n\n\tif ( d === 0 )\n\t\th = 0;\n\telse {\n\t\tswitch(max) {\n\t\t\tcase r:\n\t\t\t\th = (g - b) / d + (g < b ? 6 : 0);\n\t\t\t\tbreak;\n\t\t\tcase g:\n\t\t\t\th = (b - r) / d + 2;\n\t\t\t\tbreak;\n\t\t\tcase b:\n\t\t\t\th = (r - g) / d + 4;\n\t\t}\n\t\th /= 6;\n\t}\n\n\treturn new HSVAColor(h, s, v, a === undefined ? 1 : a);\n}\n\n\nHSVAColor.prototype.toRGBA = function() { return RGBAColor.fromHSVA(this.h, this.s, this.v, this.a); }\nHSVAColor.prototype.toHSVA = function() { return this; }\nHSVAColor.prototype.toHSLA = function() { return this.toRGBA().toHSLA(); }\nHSVAColor.prototype.toXYZA = function() { return this.toRGBA().toXYZA(); }\nHSVAColor.prototype.toLUVA = function() { return this.toRGBA().toLUVA(); }\n\n\nHSVAColor.prototype._h = function(h) { return new HSVAColor(h, this.s, this.v, this.a); }\nHSVAColor.prototype._s = function(s) { return new HSVAColor(this.h, s, this.v, this.a); }\nHSVAColor.prototype._v = function(v) { return new HSVAColor(this.h, this.s, v, this.a); }\nHSVAColor.prototype._a = function(a) { return new HSVAColor(this.h, this.s, this.v, a); }\n\n\n// XYZ Colors\n\nXYZAColor.prototype.eq = function(xyz) {  return xyz.x === this.x && xyz.y === this.y && xyz.z === this.z; }\n\nXYZAColor.fromRGBA = function(r, g, b, a) {\n\tconst R = bit2linear(r / 255),\n\t\tG = bit2linear(g / 255),\n\t\tB = bit2linear(b / 255);\n\n\treturn new XYZAColor(\n\t\t0.412453 * R + 0.357580 * G + 0.180423 * B,\n\t\t0.212671 * R + 0.715160 * G + 0.072169 * B,\n\t\t0.019334 * R + 0.119193 * G + 0.950227 * B,\n\t\ta === undefined ? 1 : a\n\t);\n}\n\nXYZAColor.fromLUVA = function(l, u, v, alpha) {\n\tconst deltaGammaFactor = 1 / (XYZAColor.WHITE.x + 15 * XYZAColor.WHITE.y + 3 * XYZAColor.WHITE.z),\n\t\tuDeltaGamma = 4 * XYZAColor.WHITE.x * deltaGammaFactor,\n\t\tvDeltagamma = 9 * XYZAColor.WHITE.y * deltaGammaFactor;\n\n\t// XYZAColor.EPSILON * XYZAColor.KAPPA = 8\n\tconst Y = (l > 8) ? Math.pow((l + 16) / 116, 3) : l / XYZAColor.KAPPA,\n\t\ta = 1/3 * (((52 * l) / (u + 13 * l * uDeltaGamma)) - 1),\n\t\tb = -5 * Y,\n\t\tc = -1/3,\n\t\td = Y * (((39 * l) / (v + 13 * l * vDeltagamma)) - 5),\n\n\t\tX = (d - b) / (a - c),\n\t\tZ = X * a + b;\n\n\treturn new XYZAColor(X, Y, Z, alpha === undefined ? 1 : alpha);\n}\n\n\nXYZAColor.prototype.toRGBA = function() { return RGBAColor.fromXYZA(this.x, this.y, this.z, this.a); }\nXYZAColor.prototype.toLUVA = function() { return LUVAColor.fromXYZA(this.x, this.y, this.z, this.a); }\nXYZAColor.prototype.toHSLA = function() { return this.toRGBA().toHSLA(); }\nXYZAColor.prototype.toHSVA = function() { return this.toRGBA().toHSVA(); }\nXYZAColor.prototype.toXYZA = function() { return this; }\n\n\nXYZAColor.prototype._x = function(x) { return new XYZAColor(x, this.y, this.z, this.a); }\nXYZAColor.prototype._y = function(y) { return new XYZAColor(this.x, y, this.z, this.a); }\nXYZAColor.prototype._z = function(z) { return new XYZAColor(this.x, this.y, z, this.a); }\nXYZAColor.prototype._a = function(a) { return new XYZAColor(this.x, this.y, this.z, a); }\n\n\n// LUV Colors\n\nXYZAColor.EPSILON = Math.pow(6 / 29, 3);\nXYZAColor.KAPPA = Math.pow(29 / 3, 3);\nXYZAColor.WHITE = (new RGBAColor(255, 255, 255, 1)).toXYZA();\n\n\nLUVAColor.prototype.eq = function(luv) { return luv.l === this.l && luv.u === this.u && luv.v === this.v; }\n\nLUVAColor.fromXYZA = function(X, Y, Z, a) {\n\tconst deltaGammaFactor = 1 / (XYZAColor.WHITE.x + 15 * XYZAColor.WHITE.y + 3 * XYZAColor.WHITE.z),\n\t\tuDeltaGamma = 4 * XYZAColor.WHITE.x * deltaGammaFactor,\n\t\tvDeltagamma = 9 * XYZAColor.WHITE.y * deltaGammaFactor,\n\n\t\tyGamma = Y / XYZAColor.WHITE.y;\n\n\tlet deltaDivider = (X + 15 * Y + 3 * Z);\n\tif (deltaDivider === 0) {\n\t\tdeltaDivider = 1;\n\t}\n\n\tconst deltaFactor = 1 / deltaDivider,\n\n\t\tuDelta = 4 * X * deltaFactor,\n\t\tvDelta = 9 * Y * deltaFactor,\n\n\t\tL = (yGamma > XYZAColor.EPSILON) ? 116 * Math.pow(yGamma, 1/3) - 16 : XYZAColor.KAPPA * yGamma,\n\t\tu = 13 * L * (uDelta - uDeltaGamma),\n\t\tv = 13 * L * (vDelta - vDeltagamma);\n\n\treturn new LUVAColor(L, u, v, a === undefined ? 1 : a);\n}\n\n\nLUVAColor.prototype.toXYZA = function() { return XYZAColor.fromLUVA(this.l, this.u, this.v, this.a); }\nLUVAColor.prototype.toRGBA = function() { return this.toXYZA().toRGBA(); }\nLUVAColor.prototype.toHSLA = function() { return this.toXYZA().toHSLA(); }\nLUVAColor.prototype.toHSVA = function() { return this.toXYZA().toHSVA(); }\nLUVAColor.prototype.toLUVA = function() { return this; }\n\n\nLUVAColor.prototype._l = function(l) { return new LUVAColor(l, this.u, this.v, this.a); }\nLUVAColor.prototype._u = function(u) { return new LUVAColor(this.l, u, this.v, this.a); }\nLUVAColor.prototype._v = function(v) { return new LUVAColor(this.l, this.u, v, this.a); }\nLUVAColor.prototype._a = function(a) { return new LUVAColor(this.l, this.u, this.v, a); }\n\n\n\nexport class ColorAdjuster {\n\tconstructor(base = '#232323', mode = 0, contrast = 4.5) {\n\t\tthis._contrast = contrast;\n\t\tthis._base = base;\n\t\tthis._mode = mode;\n\n\t\tthis.rebuildContrast();\n\t}\n\n\tget contrast() { return this._contrast }\n\tset contrast(val) { this._contrast = val; this.rebuildContrast() }\n\n\tget base() { return this._base }\n\tset base(val) { this._base = val; this.rebuildContrast() }\n\n\tget dark() { return this._dark }\n\n\tget mode() { return this._mode }\n\tset mode(val) { this._mode = val; this.rebuildContrast() }\n\n\n\trebuildContrast() {\n\t\tthis._cache = new Map();\n\n\t\tconst base = RGBAColor.fromCSS(this._base),\n\t\t\tlum = base.luminance();\n\n\t\tconst dark = this._dark = lum < 0.33;\n\n\t\tif ( dark ) {\n\t\t\tthis._luv = new XYZAColor(\n\t\t\t\t0,\n\t\t\t\t(this._contrast * (base.toXYZA().y + 0.05) - 0.05),\n\t\t\t\t0,\n\t\t\t\t1\n\t\t\t).toLUVA().l;\n\n\t\t\tthis._luma = this._contrast * (base.luminance() + 0.05) - 0.05;\n\n\t\t} else {\n\t\t\tthis._luv = new XYZAColor(\n\t\t\t\t0,\n\t\t\t\t(base.toXYZA().y + 0.05) / this._contrast - 0.05,\n\t\t\t\t0,\n\t\t\t\t1\n\t\t\t).toLUVA().l;\n\n\t\t\tthis._luma = (base.luminance() + 0.05) / this._contrast - 0.05;\n\t\t}\n\t}\n\n\tprocess(color, throw_errors = false) {\n\t\tif ( this._mode === -1 )\n\t\t\treturn '';\n\t\telse if ( this._mode === 0 )\n\t\t\treturn color;\n\n\t\tif ( color instanceof RGBAColor )\n\t\t\tcolor = color.toCSS();\n\n\t\tif ( ! color )\n\t\t\treturn null;\n\n\t\tif ( this._cache.has(color) )\n\t\t\treturn this._cache.get(color);\n\n\t\tlet rgb;\n\n\t\ttry {\n\t\t\trgb = RGBAColor.fromCSS(color);\n\t\t} catch(err) {\n\t\t\tif ( throw_errors )\n\t\t\t\tthrow err;\n\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( this._mode === 1 ) {\n\t\t\t// HSL Luma\n\t\t\tconst luma = rgb.luminance();\n\n\t\t\tif ( this._dark ? luma < this._luma : luma > this._luma )\n\t\t\t\trgb = rgb.toHSLA().targetLuminance(this._luma).toRGBA();\n\n\t\t} else if ( this._mode === 2 ) {\n\t\t\t// LUV\n\t\t\tconst luv = rgb.toLUVA();\n\t\t\tif ( this._dark ? luv.l < this._luv : luv.l > this._luv )\n\t\t\t\trgb = luv._l(this._luv).toRGBA();\n\n\t\t} else if ( this._mode === 3 ) {\n\t\t\t// HSL Loop (aka BTTV Style)\n\t\t\tif ( this._dark )\n\t\t\t\twhile ( rgb.get_Y() < 0.5 ) {\n\t\t\t\t\tconst hsl = rgb.toHSLA();\n\t\t\t\t\trgb = hsl._l(Math.min(Math.max(0, 0.1 + 0.9 * hsl.l), 1)).toRGBA();\n\t\t\t\t}\n\n\t\t\telse\n\t\t\t\twhile ( rgb.get_Y() >= 0.5 ) {\n\t\t\t\t\tconst hsl = rgb.toHSLA();\n\t\t\t\t\trgb = hsl._l(Math.min(Math.max(0, 0.9 * hsl.l), 1)).toRGBA();\n\t\t\t\t}\n\n\t\t} else if ( this._mode === 4 ) {\n\t\t\t// RGB Loop\n\t\t\tlet i = 0;\n\t\t\tif ( this._dark )\n\t\t\t\twhile ( rgb.luminance() < 0.15 && i++ < 127 )\n\t\t\t\t\trgb = rgb.brighten();\n\n\t\t\telse\n\t\t\t\twhile ( rgb.luminance() > 0.3 && i++ < 127 )\n\t\t\t\t\trgb = rgb.brighten(-1);\n\t\t}\n\n\t\tconst out = rgb.toCSS();\n\t\tthis._cache.set(color, out);\n\t\treturn out;\n\t}\n}","import React from 'react';\r\nimport { Configuration } from \"./Types\";\r\nimport { ColorAdjuster } from './Color';\r\nimport { Pronouns } from './Chat';\r\n\r\n\r\nexport const ConfigContext = React.createContext<Configuration | null>(null);\r\nexport const ColorContext = React.createContext<ColorAdjuster>(new ColorAdjuster());\r\nexport const BadgesContext = React.createContext<Map<string, string[]>>(new Map());\r\nexport const EmotesContext = React.createContext<Map<string, string[]>>(new Map());\r\nexport const PronounsContext = React.createContext<Pronouns | null>(null);\r\n","import { ClientId } from \"./ClientId\";\r\n\r\nexport const fetchTwitch = async (path: string) => {\r\n  let response = await fetch(path, { headers: { \"Client-ID\": ClientId } });\r\n  return await response.json();\r\n}\r\n\r\nexport const fetchJSON = async (path: string) => {\r\n  let response = await fetch(path);\r\n  return await response.json();\r\n}\r\n\r\nexport const createBadgeSrcSet = (urls: string[]) => {\r\n  const scaleMap = [\"18px\", \"28px\", \"36px\", \"54px\"]\r\n  return urls.map((str, i) => i === 0 ? `${str} ` : `${str} ${i + 1}x`)\r\n             .join(', ')\r\n};\r\n\r\nexport const createEmoteSrcSet= (urls: string[]) => {\r\n  const scaleMap = [\"28px\", \"42px\", \"56px\", \"84px\"]\r\n  return urls.map((str, i) => i === 0 ? `${str} ` : `${str} ${i + 1}x`)\r\n             .join(', ')\r\n};","export const ClientId = 'gp762nuuoqcoxypju8c569th9wz7q5';","import { BadgesContext, ConfigContext } from \"./Contexts\";\r\nimport React, { useContext } from 'react';\r\nimport { createBadgeSrcSet } from \"./Utils\";\r\n\r\ninterface BadgesProps {\r\n  badges?: string\r\n}\r\n\r\nexport const Badges = (props: BadgesProps) => {\r\n  const configContext = useContext(ConfigContext);\r\n  const badgeContext = useContext(BadgesContext);\r\n\r\n  if(!configContext?.showBadges) return null;\r\n\r\n  let emoteScale = Math.max(1, Math.min(4, Math.round(configContext!.fontSize / 15)))\r\n  let badges = props.badges ?? \"\";\r\n  let badgeElements: Array<any> = [];\r\n  for (const badge of badges.split(',')) {\r\n    let badgeData = badgeContext.get(badge);\r\n    if (!badgeData) continue;\r\n\r\n    badgeElements.push(<img className={\"badge badge-scale-\" + emoteScale} alt={\"\"} key={badge} src={badgeData[0]} srcSet={createBadgeSrcSet(badgeData)} />)\r\n  }\r\n\r\n  return (\r\n    <>{badgeElements}</>\r\n  )\r\n}","import React, { useContext } from 'react';\r\nimport { ConfigContext, EmotesContext } from \"./Contexts\";\r\nimport { Emote, TwitchEmote } from './Types';\r\nimport { createEmoteSrcSet } from './Utils';\r\n\r\ninterface ContentProps {\r\n  text: string;\r\n  emotes: string;\r\n}\r\n\r\n\r\nexport const Content = (props: ContentProps) => {\r\n  let text = props.text;\r\n  let rawEmotes = props.emotes ?? \"\"\r\n\r\n  // this has to be done before you parse emotes\r\n  let isMe = false;\r\n  if (/^\\x01ACTION.*\\x01$/.test(text)) {\r\n    isMe = true;\r\n    text = text.replace(/^\\x01ACTION/, '').replace(/\\x01$/, '').trim();\r\n  }\r\n\r\n  // emotes appear as <emoteid>:<start>-<end>,<start>-<end>/ (e.g. 302347771:16-26,33-43)\r\n  let emotes: Array<TwitchEmote> = [];\r\n  for (const emote of rawEmotes.split('/')) {\r\n    if (!emote) continue;\r\n\r\n    const [emoteId, indicies] = emote.split(':');\r\n    for (const indexSet of indicies.split(',')) {\r\n      const [start, end] = indexSet.split('-');\r\n      emotes.push({\r\n        id: emoteId,\r\n        urls: [\r\n          `https://static-cdn.jtvnw.net/emoticons/v2/${emoteId}/default/dark/1.0`,\r\n          `https://static-cdn.jtvnw.net/emoticons/v2/${emoteId}/default/dark/2.0`,\r\n          `https://static-cdn.jtvnw.net/emoticons/v2/${emoteId}/default/dark/3.0`,\r\n        ],\r\n        start: Math.max(+start, 0),\r\n        end: Math.min(+end + 1, text.length)\r\n      });\r\n    }\r\n  }\r\n\r\n  let channelEmotes = useContext(EmotesContext);\r\n  let idx = -1;\r\n  let nextIdx = 0;\r\n  do {\r\n    nextIdx = text.indexOf(' ', idx + 1);\r\n    if (nextIdx === -1) {\r\n      nextIdx = text.length;\r\n    }\r\n\r\n    let name = text.slice(idx + 1, nextIdx);\r\n    let emote = channelEmotes.get(name);\r\n    if (emote) {      \r\n      emotes.push({\r\n        id: name,\r\n        urls: emote,\r\n        start: Math.max(idx + 1, 0),\r\n        end: Math.min(nextIdx, text.length)\r\n      });\r\n    }\r\n  } while ((idx = text.indexOf(' ', nextIdx)) !== -1);\r\n\r\n  emotes.sort((x, y) => x.start - y.start);\r\n\r\n  let index = 0;\r\n  let content: Array<string | Emote> = [];\r\n  for (const emote of emotes) {\r\n    content.push(text.slice(index, emote.start));\r\n    content.push({\r\n      id: emote.id,\r\n      urls: emote.urls,\r\n      key: `${emote.start}-${emote.end}`\r\n    });\r\n    index = emote.end;\r\n  }\r\n\r\n  content.push(text.substr(index, text.length - index));  \r\n\r\n  let config = useContext(ConfigContext);\r\n  let emoteScale = Math.max(1, Math.min(4, Math.round(config!.fontSize / 15)))\r\n  let elements: Array<any> = [];\r\n  for (const item of content) {\r\n    if (typeof item === 'string') {\r\n      elements.push(item);\r\n      continue;\r\n    }\r\n\r\n    let emote = item as Emote;\r\n    elements.push(<img className={\"emote emote-scale-\" + emoteScale} key={(item.id + \"-\" + item.key)} alt={item.id} src={emote.urls[0]} srcSet={createEmoteSrcSet(emote.urls)} />);\r\n  }\r\n\r\n  return (\r\n    <span className={\"message-content \" + (isMe ? \"me\" : \"\")}>{elements}</span>\r\n  );\r\n}","import React, { useContext } from 'react';\r\nimport { ConfigContext, PronounsContext } from \"./Contexts\";\r\n\r\ninterface PronounsProps {\r\n    nick: string;\r\n}\r\n\r\nexport const Pronouns = (props: PronounsProps) => {\r\n    const configContext = useContext(ConfigContext);\r\n    const pronounsContext = useContext(PronounsContext);\r\n    if(!configContext?.showPronouns) return null;\r\n\r\n    let display = \"\";\r\n    let pronouns = pronounsContext?.userMap.get(props.nick);\r\n    if (!pronouns) pronounsContext?.fetchPronouns(props.nick);\r\n    else {\r\n        display = pronounsContext?.displayMap.get(pronouns.pronoun) ?? \"\";\r\n    }\r\n\r\n    return (display ? <span className=\"pronouns\">{display}</span> : null);\r\n}\r\n","import React, { Component, useContext } from 'react';\r\nimport { IRCMessage } from \"irc-message-ts\";\r\nimport { DefaultConfig, TwitchDefaultColors } from './Constants';\r\nimport { Badges } from \"./Badges\"\r\nimport { Content } from \"./Content\"\r\nimport { Pronouns } from './Pronouns';\r\nimport { ColorContext, ConfigContext } from \"./Contexts\";\r\nimport { Configuration } from './Types';\r\n\r\ninterface MessageProps {\r\n  message: IRCMessage;\r\n}\r\ninterface MessageState {\r\n  timeout: number | NodeJS.Timeout;\r\n  hidden: boolean;\r\n}\r\n\r\n// export const Message = (props: MessageProps) => {\r\n// }\r\n\r\nexport class Message extends Component<MessageProps, MessageState> {\r\n\r\n  static contextType = ConfigContext;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hidden: false, timeout: 0 };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let config = this.context as Configuration;\r\n    if (config.hideMessages) {\r\n      this.setState({ timeout: setTimeout(() => console.log(this.setState({ hidden: true })), config.hideMessagesTimeout) })\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout as number);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <ConfigContext.Consumer>\r\n        {(config =>\r\n          <ColorContext.Consumer>\r\n            {(adjuster => {\r\n              let message = this.props.message;\r\n              let rawNick = message.prefix?.split('@')[0].split('!')[0];\r\n\r\n              if (config?.blockedUsers.includes(rawNick!.toLowerCase())) { return null; }\r\n              if (config?.hideCommands && message.params[1].startsWith('!')) { return null; }\r\n\r\n              let nick = message.tags[\"display-name\"] ?? rawNick;\r\n              let color: string = \"inherit\";\r\n\r\n              if (config?.showUserColours) {\r\n                color = adjuster.process(!message.tags.color ? TwitchDefaultColors[nick.toLowerCase().charCodeAt(0) % 15] : message.tags.color);\r\n              }\r\n\r\n              return (\r\n                <p className={\"message\" + (this.state.hidden ? \" hidden\" : \"\")}>\r\n                  <Badges badges={message.tags.badges} />\r\n                  <Pronouns nick={rawNick!} />\r\n                  <span className=\"nick\" style={{ color }}>{nick}</span>\r\n                  <Content text={message.params[1]} emotes={message.tags.emotes} />\r\n                </p>\r\n              );\r\n            })}\r\n          </ColorContext.Consumer>\r\n        )}\r\n      </ConfigContext.Consumer>\r\n    )\r\n\r\n  }\r\n}","import { Component } from 'react';\nimport { parse, IRCMessage } from \"irc-message-ts\";\nimport { Message } from \"./Message\"\nimport { BTTVEmote, BTTVUser, Configuration, EmoteEventUpdate } from \"./Types\"\nimport { fetchJSON, fetchTwitch } from \"./Utils\"\nimport { ColorAdjuster } from './Color';\nimport './Chat.css';\nimport { ConfigContext, ColorContext, BadgesContext, EmotesContext, PronounsContext } from './Contexts';\n\ninterface ChatState {\n  connected: boolean;\n  messages: Array<IRCMessage>\n  badges: Map<string, string[]>;\n  emotes: Map<string, string[]>;\n  colorAdjuster: ColorAdjuster;\n\n  pronounDisplay: Map<string, string>;\n  pronounUsers: Map<string, Pronoun>;\n\n  channelId?: string;\n  channelName?: string;\n  webSocket?: WebSocket;\n  sevenTvEvents?: EventSource;\n\n  errorMessage?: string;\n}\n\ninterface Pronoun {\n  pending: boolean;\n  pronoun: string;\n}\n\nexport interface Pronouns {\n  displayMap: Map<string, string>;\n  userMap: Map<string, Pronoun>;\n  fetchPronouns: (nick: string) => void;\n}\n\nexport class Chat extends Component<Configuration, ChatState> {\n  constructor(props: any) {\n    super(props);\n    let state: ChatState = {\n      connected: false,\n      messages: [],\n      badges: new Map(),\n      emotes: new Map(),\n      pronounUsers: new Map(),\n      pronounDisplay: new Map(),\n      colorAdjuster: new ColorAdjuster()\n    };\n    this.state = state;\n  }\n\n  async componentDidMount() {\n    await this.load();\n  }\n\n  async componentDidUpdate(previousProps) {\n    if (this.props.channelName !== previousProps.channelName) {\n      await this.load();\n    }\n\n    if (this.props.readableColours !== previousProps.readableColours ||\n      this.props.readableContrast !== previousProps.readableContrast ||\n      this.props.readableBackground !== previousProps.readableBackground ||\n      this.props.readableMode !== previousProps.readableMode) {\n      this.setState({ colorAdjuster: new ColorAdjuster(this.props.readableBackground, (!this.props.readableColours ? 0 : this.props.readableMode), this.props.readableContrast) });\n    }\n  }\n\n  componentWillUnmount() {\n    this.cleanup();\n  }\n\n  async load() {\n    this.cleanup();\n\n    if (!this.props.channelName) {\n      this.setState({ errorMessage: \"No channel specifed!\" });\n      return;\n    }\n\n    let data = await fetchTwitch(`https://api.twitch.tv/v5/users?login=${this.props.channelName}`);\n    if (!data.users?.length) {\n      this.setState({ errorMessage: \"Specified channel doesn't exist!\" });\n      return;\n    }\n\n    this.setState({ channelId: data.users[0]._id, channelName: this.props.channelName });\n    this.connect();\n\n    let encodedId = encodeURIComponent(this.state.channelId!);\n    await Promise.all([this.loadBadges(encodedId), this.loadEmotes(encodedId), this.loadPronouns()]);\n  }\n\n  private cleanup() {\n    let socket = this.state.webSocket;\n    let events = this.state.sevenTvEvents;\n\n    this.setState({\n      errorMessage: undefined,\n      messages: [],\n      colorAdjuster: new ColorAdjuster(this.props.readableBackground, this.props.readableMode, this.props.readableContrast),\n      webSocket: undefined,\n      sevenTvEvents: undefined,\n      emotes: new Map(),\n      badges: new Map(),\n      pronounUsers: new Map(),\n      pronounDisplay: new Map(),\n      connected: false\n    });\n\n    if (socket) {\n      socket.close(1000, \"Closing\");\n    }\n    if (events) {\n      events.close();\n    }\n  }\n\n  private connect() {\n    // just to be doubly sure\n    if (this.state.webSocket) {\n      this.state.webSocket.close(1000, \"Closing\");\n    }\n\n    let socket = new WebSocket(\"wss://irc-ws.chat.twitch.tv\", 'irc');\n    socket.addEventListener(\"open\", this.onSocketOpen.bind(this));\n    socket.addEventListener(\"close\", this.onSocketClose.bind(this));\n    socket.addEventListener(\"error\", this.onSocketError.bind(this));\n    socket.addEventListener(\"message\", this.onSocketMessage.bind(this));\n    this.setState({ webSocket: socket });\n  }\n\n  private async loadBadges(encodedId: string) {\n    let badgeSets = await Promise.all([ // TODO: FFZ custom badges\n      fetchTwitch(`https://badges.twitch.tv/v1/badges/global/display`),\n      fetchTwitch(`https://badges.twitch.tv/v1/badges/channels/${encodedId}/display`)\n    ]);\n\n    let badges = new Map<string, string[]>();\n    for (const badgeSet of badgeSets) {\n      let set = badgeSet.badge_sets;\n      for (const badgeName in set) {\n        for (const badgeVersion in set[badgeName].versions) {\n          badges.set(`${badgeName}/${badgeVersion}`, [\n            set[badgeName].versions[badgeVersion].image_url_1x,\n            set[badgeName].versions[badgeVersion].image_url_2x,\n            set[badgeName].versions[badgeVersion].image_url_4x,\n          ]);\n        }\n      }\n    }\n\n    console.log(\"Loaded badges\", badges);\n    this.setState({ badges });\n  }\n\n  private async loadEmotes(encodedId: string) {\n    let emotes = new Map<string, string[]>();\n    let bttvEmotes: Array<Array<BTTVEmote> | BTTVUser> = await Promise.all([\n      fetchJSON('https://api.betterttv.net/3/cached/frankerfacez/emotes/global'),\n      fetchJSON(`https://api.betterttv.net/3/cached/frankerfacez/users/twitch/${encodedId}`),\n      fetchJSON('https://api.betterttv.net/3/cached/emotes/global'),\n      fetchJSON(`https://api.betterttv.net/3/cached/users/twitch/${encodedId}`),\n      fetchJSON('https://api.7tv.app/v2/emotes/global'),\n      fetchJSON(`https://api.7tv.app/v2/users/${encodedId}/emotes`),\n    ]);\n\n    for (let emoteSet of bttvEmotes) {\n      if (!Array.isArray(emoteSet)) {\n        if (emoteSet.channelEmotes) {\n          emoteSet = emoteSet.channelEmotes.concat(emoteSet.sharedEmotes);\n        }\n      }\n\n      if (!Array.isArray(emoteSet)) continue;\n\n      for (const emote of emoteSet as Array<BTTVEmote>) {\n        if (emote.images) {\n          emotes.set(emote.code, [emote.images['1x'], emote.images['2x'], emote.images['4x']]);\n          continue;\n        }\n\n        if (emote.code) {\n          emotes.set(emote.code, [\n            `https://cdn.betterttv.net/emote/${emote.id}/1x`,\n            `https://cdn.betterttv.net/emote/${emote.id}/2x`,\n            `https://cdn.betterttv.net/emote/${emote.id}/3x`\n          ]);\n\n          continue;\n        }\n\n        if (emote.urls && emote.name) {\n          emotes.set(emote.name, emote.urls.map(e => e[1]));\n          continue;\n        }\n      }\n    }\n\n    this.sevenTVSubscribe();\n\n    console.log(\"Loaded emotes\", emotes);\n    this.setState({ emotes });\n  }\n\n  private async sevenTVSubscribe() {\n    let eventSource = new EventSource(`https://events.7tv.app/v1/channel-emotes?channel=${this.state.channelName!}`);\n\n    eventSource.addEventListener('ready', (ev: Event) => {\n      let message = ev as MessageEvent; // this is stupid lol\n      console.log(`7TV ready, ${message.data}`);\n    })\n\n    eventSource.addEventListener('update', (ev: Event) => {\n      let message = ev as MessageEvent; // this is stupid lol\n      let eventUpdate = JSON.parse(message.data) as EmoteEventUpdate;\n      if (eventUpdate === undefined) return;\n\n      let emotes = new Map<string, string[]>(this.state.emotes);\n\n      if (eventUpdate.action === \"ADD\") {\n        emotes.set(eventUpdate.name, [\n          `https://cdn.7tv.app/emote/${eventUpdate.emote_id}/1x`,\n          `https://cdn.7tv.app/emote/${eventUpdate.emote_id}/2x`,\n          `https://cdn.7tv.app/emote/${eventUpdate.emote_id}/3x`,\n        ]);\n\n        console.log(`7TV emotes: added ${eventUpdate.name}!`)\n      }\n      else if (eventUpdate.action === \"REMOVE\") {\n        emotes.delete(eventUpdate.name);\n        console.log(`7TV emotes: removed ${eventUpdate.name}!`)\n      }\n\n      this.setState({ emotes });\n    })\n\n    this.setState({ sevenTvEvents: eventSource });\n  }\n\n  private async loadPronouns() {\n    let pronouns = new Map<string, string>();\n    let pronounsJson = await fetchJSON(\"https://pronouns.alejo.io/api/pronouns\");\n    for (const value of pronounsJson) {\n      pronouns.set(value.name, value.display);\n    }\n\n    this.setState({ pronounDisplay: pronouns });\n  }\n\n  private async fetchPronouns(userName: string) {\n    if (this.state.pronounUsers.has(userName)) return;\n    this.state.pronounUsers.set(userName, { pending: true, pronoun: \"\" });\n\n    let json = await fetchJSON(`https://pronouns.alejo.io/api/users/${userName}`);\n    if (!Array.isArray(json)) return;\n\n    this.state.pronounUsers.set(userName, { pending: false, pronoun: json[0]?.pronoun_id });\n    this.setState({ pronounUsers: this.state.pronounUsers });\n  }\n\n  onSocketOpen(ev: Event) {\n    this.sendIrc(`PASS ass`);\n    this.sendIrc(`NICK justinfan${Math.floor(Math.random() * 65536)}`);\n    this.sendIrc(`CAP REQ :twitch.tv/commands twitch.tv/tags`);\n    this.sendIrc(`JOIN #${this.props.channelName}`);\n  }\n\n  onSocketError(ev: Event) {\n    this.state.webSocket?.close(1000, \"Closing\");\n  }\n\n  onSocketClose(ev: CloseEvent) {\n    if(!this.state.webSocket) {\n      console.log(`Orphaned socket closed: ${ev.code} ${ev.reason}.`);\n      return;\n    }\n    console.log(`Socket closed: ${ev.code} ${ev.reason}. Reconnecting in 5 seconds...`);\n    setTimeout(() => this.connect(), 5000);\n  }\n\n  onSocketMessage(ev: MessageEvent<string>) {\n    for (const message of ev.data.split('\\r\\n')) {\n      if (!message) continue;\n      let ircMessage = parse(message)!;\n      if (ircMessage === null) continue;\n\n      let command = ircMessage.command?.toLowerCase();\n      if (!command) continue;\n\n      switch (command) {\n        case \"ping\":\n          this.sendIrc(`PONG :${ircMessage.params[0]}`);\n          continue;\n        // case \"clearchat\":\n        //   this.setState({ messages: [] });\n        //   continue;\n        case \"privmsg\":\n          this.setState(oldState => ({ messages: [...(oldState.messages.length >= 50 ? oldState.messages.slice(1, 50) : oldState.messages), ircMessage] }));\n          continue;\n      }\n    }\n  }\n\n  sendIrc(message: string) {\n    if (this.state.webSocket === undefined) throw new Error(\"what the fuck lol\");\n    this.state.webSocket.send(message + '\\r\\n');\n  }\n\n  render() {\n    let style = {\n      color: this.props.fontColor ?? \"white\",\n      fill: this.props.fontColor ?? \"white\",\n      fontFamily: this.props.fontName,\n      fontSize: this.props.fontSize + \"pt\",\n      fontWeight: this.props.fontWeight,\n      filter: \"\",\n      WebkitTextStroke: \"\",\n      stroke: \"\",\n      strokeWidth: \"\",\n    }\n\n    if (this.props.dropShadow) {\n      style.filter = style.filter + `drop-shadow(${this.props.dropShadowOffset}px ${this.props.dropShadowOffset}px ${this.props.dropShadowBlur}px ${this.props.dropShadowColour})`\n    }\n\n    if (this.props.outline) {\n      style.WebkitTextStroke = `${this.props.outlineThickness}px ${this.props.outlineColour}`\n      style.stroke = this.props.outlineColour!\n      style.strokeWidth = `${this.props.outlineThickness! * 7.5}px`\n    }\n\n    if (this.state.errorMessage) {\n      return (\n        <div className=\"chat-container\" style={style}>\n          <div className=\"chat-error\">\n            <svg height=\"128px\" viewBox=\"0 0 960 960\" width=\"128px\" xmlns=\"http://www.w3.org/2000/svg\" xmlnsXlink=\"http://www.w3.org/1999/xlink\">\n              <path d=\"M0,480C0,435.667 5.66667,393.083 17,352.25C28.3333,311.417 44.4167,273.167 65.25,237.5C86.0833,201.833 111.083,169.417 140.25,140.25C169.417,111.083 201.833,86.0834 237.5,65.25C273.167,44.4167 311.417,28.3334 352.25,17C393.083,5.66669 435.667,0 480,0C524,0 566.417,5.75 607.25,17.25C648.083,28.75 686.333,44.9167 722,65.75C757.667,86.5834 790.083,111.583 819.25,140.75C848.417,169.917 873.417,202.333 894.25,238C915.083,273.667 931.25,311.917 942.75,352.75C954.25,393.583 960,436 960,480C960,524.333 954.333,566.917 943,607.75C931.667,648.583 915.583,686.833 894.75,722.5C873.917,758.167 848.917,790.583 819.75,819.75C790.583,848.917 758.167,873.917 722.5,894.75C686.833,915.583 648.583,931.667 607.75,943C566.917,954.333 524.333,960 480,960C435.667,960 393,954.333 352,943C311,931.667 272.75,915.583 237.25,894.75C201.75,873.917 169.417,848.917 140.25,819.75C111.083,790.583 86.0833,758.25 65.25,722.75C44.4167,687.25 28.3333,649 17,608C5.66667,567 0,524.333 0,480ZM896,480C896,441.667 891.083,404.75 881.25,369.25C871.417,333.75 857.417,300.583 839.25,269.75C821.083,238.917 799.417,210.917 774.25,185.75C749.083,160.583 721.083,138.917 690.25,120.75C659.417,102.583 626.25,88.5834 590.75,78.75C555.25,68.9167 518.333,64.0001 480,64C441.667,64.0001 404.75,68.9167 369.25,78.75C333.75,88.5834 300.583,102.5 269.75,120.5C238.917,138.5 210.833,160.167 185.5,185.5C160.167,210.833 138.5,238.917 120.5,269.75C102.5,300.583 88.5833,333.75 78.75,369.25C68.9167,404.75 64,441.667 64,480C64,518.333 68.9167,555.25 78.75,590.75C88.5833,626.25 102.5,659.417 120.5,690.25C138.5,721.083 160.167,749.167 185.5,774.5C210.833,799.833 238.917,821.5 269.75,839.5C300.583,857.5 333.75,871.417 369.25,881.25C404.75,891.083 441.667,896 480,896C518.333,896 555.25,891.083 590.75,881.25C626.25,871.417 659.417,857.417 690.25,839.25C721.083,821.083 749.083,799.417 774.25,774.25C799.417,749.083 821.083,721.083 839.25,690.25C857.417,659.417 871.417,626.25 881.25,590.75C891.083,555.25 896,518.333 896,480ZM448,544L448,288C448,279.333 451.167,271.833 457.5,265.5C463.833,259.167 471.333,256 480,256C488.667,256 496.167,259.167 502.5,265.5C508.833,271.833 512,279.333 512,288L512,544C512,552.667 508.833,560.167 502.5,566.5C496.167,572.833 488.667,576 480,576C471.333,576 463.833,572.833 457.5,566.5C451.167,560.167 448,552.667 448,544ZM432,672C432,658.667 436.667,647.333 446,638C455.333,628.667 466.667,624 480,624C493.333,624 504.667,628.667 514,638C523.333,647.333 528,658.667 528,672C528,685.333 523.333,696.667 514,706C504.667,715.333 493.333,720 480,720C466.667,720 455.333,715.333 446,706C436.667,696.667 432,685.333 432,672Z\" />\n            </svg>\n            <p>{this.state.errorMessage}</p>\n          </div>\n        </div>\n      )\n    }\n    return (\n      <div className=\"chat-container\">\n        <div className=\"chat-root\" style={style}>\n          <ConfigContext.Provider value={this.props}>\n            <ColorContext.Provider value={this.state.colorAdjuster}>\n              <BadgesContext.Provider value={this.state.badges}>\n                <EmotesContext.Provider value={this.state.emotes}>\n                  <PronounsContext.Provider value={{ userMap: this.state.pronounUsers, displayMap: this.state.pronounDisplay, fetchPronouns: this.fetchPronouns.bind(this) }}>\n                    {this.state.messages.map(m => <Message key={m.tags.id} message={m} />)}\n                  </PronounsContext.Provider>\n                </EmotesContext.Provider>\n              </BadgesContext.Provider>\n            </ColorContext.Provider>\n          </ConfigContext.Provider>\n        </div>\n      </div>\n    )\n  }\n}","\r\nimport React from \"react\";\r\nimport { Chat } from \"./Chat\";\r\nimport { Configurator } from \"./Configurator\";\r\nimport { Configuration } from \"./Types\";\r\nimport { decode } from \"@msgpack/msgpack\"\r\nimport { DefaultConfig } from \"./Constants\";\r\n\r\nexport const App = () => {\r\n  let config: Configuration = DefaultConfig;\r\n  try {\r\n    let newConfig = decode(Buffer.from(window.location.hash.substring(1), 'base64')) as Partial<Configuration>;\r\n\r\n    console.log(config, newConfig);\r\n\r\n    config = Object.assign(config, newConfig);\r\n  }\r\n  catch (e) { }\r\n\r\n  return (\r\n    !!config.channelName ? <Chat {...config as Configuration} /> : <Configurator />\r\n  );\r\n};","import React, { ChangeEvent, Component } from 'react';\r\nimport { Chat } from './Chat';\r\nimport { Configuration } from './Types';\r\nimport * as MsgPack from \"@msgpack/msgpack\"\r\nimport \"./config.css\"\r\nimport { DefaultConfig } from './Constants';\r\n\r\ninterface ConfiguratorState {\r\n  config: Configuration;\r\n  chatConfig?: Configuration;\r\n}\r\n\r\n\r\nconst Checkbox = (props: { label: string, value: boolean, onChange: (event: ChangeEvent<HTMLInputElement>) => void }) => {\r\n  return (\r\n    <label className=\"checkbox\">\r\n      <input type=\"checkbox\"\r\n        checked={props.value}\r\n        onChange={props.onChange} />\r\n      <span className=\"checkmark\"></span> {props.label}\r\n    </label>\r\n  )\r\n}\r\n\r\n\r\nexport class Configurator extends Component<{}, ConfiguratorState> {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { config: DefaultConfig, chatConfig: DefaultConfig };\r\n  }\r\n\r\n  updateChat() {\r\n    this.setState({ chatConfig: this.state.config });\r\n  }\r\n\r\n  onChannelNameChange(e) {\r\n    this.setState({ config: { ...this.state.config, channelName: e.target.value } });\r\n  }\r\n\r\n  onValueChange<T>(name: string, newValue: T) {\r\n    if (this.state[name] != newValue)\r\n      this.setState({ config: { ...this.state.config, [name]: newValue }, chatConfig: { ...this.state.config, [name]: newValue } });\r\n  }\r\n\r\n  showHelpDialog() {\r\n\r\n  }\r\n\r\n  onSubmit(e) {\r\n    e.preventDefault();\r\n  }\r\n\r\n  render() {\r\n    let configDiff = {};\r\n    for (const key in this.state.config) {\r\n      const element = this.state.config[key];\r\n      const element2 = DefaultConfig[key];\r\n      if (element !== element2) {\r\n        configDiff[key] = element;\r\n      }\r\n    }\r\n\r\n    let configString = btoa(String.fromCharCode(...MsgPack.encode(configDiff)));\r\n\r\n    return (\r\n      <>\r\n        <div className=\"config-background\" />\r\n        <div className=\"config-root\">\r\n          <div className=\"config-pane\">\r\n            <div className=\"config-main\">\r\n              <form onSubmit={this.onSubmit.bind(this)} className=\"config-input\">\r\n                <h1>Wam's Chat Thing</h1>\r\n                <h4>A simple, easy to use chat box that supports <a href=\"https://betterttv.net/\">BetterTTV</a>, <a href=\"https://frankerfacez.com/\">FrankerFaceZ</a> and <a href=\"https://7tv.app/\">7tv</a> emotes!</h4>\r\n\r\n                <div className=\"config-warning\">\r\n                  <p>This chat box is not yet finished so links may break in future! Please don't use it in your layouts yet.</p>\r\n                </div>\r\n\r\n                <label className=\"form-group-label\">\r\n                  Channel Name\r\n                </label>\r\n                <div className=\"form-group\">\r\n                  <input type=\"text\"\r\n                    className=\"config-input-text\"\r\n                    placeholder=\"wamwoowam\"\r\n                    value={this.state.config.channelName}\r\n                    onChange={this.onChannelNameChange.bind(this)}\r\n                    onBlur={this.updateChat.bind(this)} />\r\n                </div>\r\n\r\n                <div className=\"form-group-label form-group-font\">\r\n                  <label className=\"form-group-font-label\">Font</label>\r\n                  <a href=\"#\" className=\"form-group-font-help\" onClick={this.showHelpDialog.bind(this)}>Help!</a>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                  <input type=\"text\"\r\n                    className=\"config-input-text\"\r\n                    placeholder=\"Font Name\"\r\n                    size={1}\r\n                    style={{ flex: 3 }}\r\n                    value={this.state.config.fontName}\r\n                    onChange={(e) => this.onValueChange(\"fontName\", e.target.value)} />\r\n\r\n                  <input type=\"text\"\r\n                    className=\"config-input-text config-input-number\"\r\n                    placeholder=\"Font Size\"\r\n                    size={1}\r\n                    value={this.state.config.fontSize}\r\n                    onChange={(e) => this.onValueChange(\"fontSize\", isNaN(+e.target.value) ? this.state.config.fontSize : +e.target.value)} />\r\n\r\n                  <select className=\"config-input-text\"\r\n                    value={this.state.config.fontWeight}\r\n                    onChange={(e) => this.onValueChange(\"fontWeight\", +e.target.value)}>\r\n                    <option value=\"100\">Thin</option>\r\n                    <option value=\"200\">Light</option>\r\n                    <option value=\"300\">Semilight</option>\r\n                    <option value=\"400\">Regular</option>\r\n                    <option value=\"500\">Semibold</option>\r\n                    <option value=\"600\">Bold</option>\r\n                    <option value=\"700\">Extra Bold</option>\r\n                    <option value=\"800\">Black</option>\r\n                    <option value=\"900\">Ultra Black</option>\r\n                  </select>\r\n\r\n                  <input type=\"color\"\r\n                    className=\"config-input-text\"\r\n                    size={1}\r\n                    value={this.state.config.fontColor}\r\n                    onChange={(e) => this.onValueChange(\"fontColor\", e.target.value)} />\r\n                </div>\r\n\r\n                <label className=\"form-group-label\">\r\n                  Ignored users (one per line)\r\n                </label>\r\n                <div className=\"form-group\">\r\n                  <textarea className=\"config-input-text\"\r\n                    value={this.state.config.blockedUsers.join('\\n')}\r\n                    onChange={(e) => this.onValueChange(\"blockedUsers\", e.target.value.split('\\n'))} />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <Checkbox label=\"Show badges\" value={this.state.config.showBadges} onChange={(e) => this.onValueChange(\"showBadges\", e.target.checked)} />\r\n                  <Checkbox label=\"Show pronouns\" value={this.state.config.showPronouns} onChange={(e) => this.onValueChange(\"showPronouns\", e.target.checked)} />\r\n                  <Checkbox label=\"Show user colours\" value={this.state.config.showUserColours} onChange={(e) => this.onValueChange(\"showUserColours\", e.target.checked)} />\r\n\r\n                  {\r\n                    this.state.config.showUserColours ?\r\n                      <Checkbox label=\"Readable colours\" value={this.state.config.readableColours} onChange={(e) => this.onValueChange(\"readableColours\", e.target.checked)} /> : null\r\n                  }\r\n\r\n                  <Checkbox label=\"Hide commands\" value={this.state.config.hideCommands} onChange={(e) => this.onValueChange(\"hideCommands\", e.target.checked)} />\r\n                  <Checkbox label=\"Temporary messages\" value={this.state.config.hideMessages} onChange={(e) => this.onValueChange(\"hideMessages\", e.target.checked)} />\r\n                  <Checkbox label=\"Drop shadow\" value={this.state.config.dropShadow} onChange={(e) => this.onValueChange(\"dropShadow\", e.target.checked)} />\r\n                  <Checkbox label=\"Outline\" value={this.state.config.outline} onChange={(e) => this.onValueChange(\"outline\", e.target.checked)} />\r\n                </div>\r\n\r\n                {this.state.config.hideMessages ? (\r\n                  <>\r\n                    <h4 className=\"form-group-header\">Temporary Messages</h4>\r\n\r\n                    <div className=\"form-group\">\r\n                      <label className=\"form-label\">\r\n                        Message Timeout (seconds)\r\n                        <input type=\"number\"\r\n                          className=\"config-input-text config-input-number\"\r\n                          placeholder=\"Message Timeout\"\r\n                          size={1}\r\n                          defaultValue={this.state.config.hideMessagesTimeout / 1000}\r\n                          onBlur={(e) => this.onValueChange(\"hideMessagesTimeout\", isNaN(+e.target.value) ? this.state.config.hideMessagesTimeout : +e.target.value  * 1000)} />\r\n                      </label>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n\r\n                {this.state.config.showUserColours && this.state.config.readableColours ? (\r\n                  <>\r\n                    <h4 className=\"form-group-header\">Readable Colour Options</h4>\r\n\r\n                    <div className=\"form-group\">\r\n                      <label className=\"form-label\">\r\n                        Target Contrast\r\n                        <input type=\"range\"\r\n                          min={0}\r\n                          max={10}\r\n                          step={0.5}\r\n                          value={this.state.config.readableContrast}\r\n                          onChange={(e) => this.onValueChange(\"readableContrast\", +e.target.value)} />\r\n                      </label>\r\n\r\n                      <label className=\"form-label\">\r\n                        Background Colour\r\n                        <input type=\"color\"\r\n                          className=\"config-input-text\"\r\n                          size={1}\r\n                          value={this.state.config.readableBackground}\r\n                          onChange={(e) => this.onValueChange(\"readableBackground\", e.target.value)} />\r\n                      </label>\r\n\r\n                      <label className=\"form-label\">\r\n                        Adjustment Mode\r\n\r\n                        <select className=\"config-input-text\"\r\n                          value={this.state.config.readableMode}\r\n                          onChange={(e) => this.onValueChange(\"readableMode\", +e.target.value)}>\r\n                          <option value=\"1\">HSL Luma (FFZ Default)</option>\r\n                          <option value=\"2\">Luv Luma</option>\r\n                          <option value=\"3\">HSL Loop (BTTV-like)</option>\r\n                          <option value=\"4\">RGB Loop</option>\r\n                        </select>\r\n                      </label>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n\r\n                {this.state.config.dropShadow ? (\r\n                  <>\r\n                    <h4 className=\"form-group-header\">Shadow Options</h4>\r\n\r\n                    <div className=\"form-group\">\r\n                      <label className=\"form-label\">\r\n                        Offset\r\n                        <input type=\"text\"\r\n                          className=\"config-input-text config-input-number\"\r\n                          placeholder=\"Shadow Offset\"\r\n                          size={1}\r\n                          value={this.state.config.dropShadowOffset}\r\n                          onChange={(e) => this.onValueChange(\"dropShadowOffset\", isNaN(+e.target.value) ? this.state.config.dropShadowOffset : +e.target.value)} />\r\n                      </label>\r\n\r\n                      <label className=\"form-label\">\r\n                        Blur Radius\r\n                        <input type=\"text\"\r\n                          className=\"config-input-text config-input-number\"\r\n                          placeholder=\"Shadow Blur Radius\"\r\n                          size={1}\r\n                          value={this.state.config.dropShadowBlur}\r\n                          onChange={(e) => this.onValueChange(\"dropShadowBlur\", isNaN(+e.target.value) ? this.state.config.dropShadowBlur : +e.target.value)} />\r\n                      </label>\r\n\r\n                      <label className=\"form-label\">\r\n                        Colour\r\n                        <input type=\"color\"\r\n                          className=\"config-input-text\"\r\n                          size={1}\r\n                          value={this.state.config.dropShadowColour}\r\n                          onChange={(e) => this.onValueChange(\"dropShadowColour\", e.target.value)} />\r\n                      </label>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n\r\n\r\n                {this.state.config.outline ? (\r\n                  <>\r\n                    <h4 className=\"form-group-header\">Outline Options</h4>\r\n\r\n                    <div className=\"form-group\">\r\n                      <label className=\"form-label\">\r\n                        Thickness\r\n                        <input type=\"text\"\r\n                          className=\"config-input-text config-input-number\"\r\n                          placeholder=\"Outline Thickness\"\r\n                          size={1}\r\n                          value={this.state.config.outlineThickness}\r\n                          onChange={(e) => this.onValueChange(\"outlineThickness\", isNaN(+e.target.value) ? this.state.config.outlineThickness : +e.target.value)} />\r\n                      </label>\r\n\r\n                      <label className=\"form-label\">\r\n                        Colour\r\n                        <input type=\"color\"\r\n                          className=\"config-input-text\"\r\n                          size={1}\r\n                          value={this.state.config.outlineColour}\r\n                          onChange={(e) => this.onValueChange(\"outlineColour\", e.target.value)} />\r\n                      </label>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n              </form>\r\n\r\n              <div className=\"config-footer\">\r\n                <p>Paste this into a browser source!</p>\r\n                <input className=\"config-input-text\" readOnly={true} value={`${window.location.href}#${configString}`} />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"config-example\">\r\n            <Chat {...this.state.chatConfig!} />\r\n          </div>\r\n        </div>\r\n      </>\r\n    )\r\n  }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\nimport './index.css';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}